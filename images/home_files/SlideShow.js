(function(a){var b=a.fn.exposure=function(c){var f="0.9.1";var j;var h={target:"#exposure",showThumbs:true,showControls:true,imageControls:false,controls:{prevNext:true,firstLast:true,pageNumbers:true},carouselControls:false,enableSlideshow:true,slideshowControlsTarget:null,autostartSlideshow:false,slideshowDelay:3000,onSlideshowPlayed:function(){},onSlideshowPaused:function(){},showCaptions:true,showExtraData:true,dataTarget:null,controlsTarget:null,onThumb:function(i){},onImage:function(o,i,n){a(".exposureWrapper > .exposureLastImage").remove()},onCarousel:function(i,n){},onNext:function(){},onPrev:function(){},onPageChanged:function(){a(".exposureThumbs li.current").show().each(function(n){var o=a(this).find("img").height();if(o>0){a(this).height(o)}})},onPagingLink:function(i){return i},separatePageBrowsing:false,loop:true,onEndOfLoop:function(){},pageSize:5,viewFirstImage:true,visiblePages:5,preloadBuffer:3,keyboardNavigation:true,clickingNavigation:true,fixedContainerSize:false,maxWidth:null,maxHeight:null,stretchToMaxSize:false,fullScreen:false,onEnterFullScreen:function(i){i.show()},onExitFullScreen:function(i,n){i.hide();n.hide()},showThumbToolTip:true,showThumbCaption:true,onEmpty:function(){a(".exposureThumbs").hide();a(a.exposure.target).remove();if(a.exposure.showControls){a(a.exposure.controlsTarget).remove()}if(a.exposure.slideshowControlsTarget){a(a.exposure.slideshowControlsTarget).remove()}},onInit:function(){},allowDuplicates:true,jsonSource:null};var e=a.extend(h,c);for(j in e){if(b.defined(h[j])){a.exposure[j]=e[j]}}if(!a(a.exposure.target).length){a('<div id="exposure"></div>').insertBefore(a(this))}var k=a('<div class="exposureWrapper"></div>');var m=a(a.exposure.target).addClass("exposureTarget").append(k);if(a.exposure.showCaption||a.exposure.showExtraData){var d="";if(a.exposure.showCaptions){d+='<div class="caption"></div>'}if(a.exposure.showExtraData){d+='<div class="extra"></div>'}var g=a(d);if(g.length){if(a.exposure.dataTarget&&a(a.exposure.dataTarget).length){a(a.exposure.dataTarget).addClass("exposureData").append(g)}else{a.exposure.dataTarget=null;m.append(a('<div class="exposureData"></div>').append(g))}}}if(!a.exposure.showThumbs){a.exposure.carouselControls=false}if(a.exposure.carouselControls||!a.exposure.controlsTarget||(!a.exposure.controls.prevNext&&!a.exposure.controls.firstLast&&!a.exposure.controls.pageNumbers)){a.exposure.showControls=false}if(a.exposure.showControls){a(a.exposure.controlsTarget).addClass("exposureControls").each(function(){if(a.exposure.controls.firstLast){a(this).append(a('<a class="exposureFirstPage" href="javascript:void(0);">'+a.exposure.texts.first+"</a>").click(a.exposure.first))}if(a.exposure.controls.prevNext){a(this).append(a('<a class="exposurePrevPage" href="javascript:void(0);">'+a.exposure.texts.previous+"</a>").click(a.exposure.prev))}if(a.exposure.controls.pageNumbers){a(this).append(a('<div class="exposurePaging"></div>'))}if(a.exposure.controls.prevNext){a(this).append(a('<a class="exposureNextPage" href="javascript:void(0);">'+a.exposure.texts.next+"</a>").click(a.exposure.next))}if(a.exposure.controls.firstLast){a(this).append(a('<a class="exposureLastPage" href="javascript:void(0);">'+a.exposure.texts.last+"</a>").click(a.exposure.last))}})}if(a.exposure.enableSlideshow&&a.exposure.slideshowControlsTarget){a(a.exposure.slideshowControlsTarget).addClass("exposureSlideshowControls").each(function(){a(this).append(a('<a class="exposurePlaySlideshow" href="javascript:void(0);">'+a.exposure.texts.play+"</a>").click(a.exposure.playSlideshow));a(this).append(a('<a class="exposurePauseSlideshow" href="javascript:void(0);">'+a.exposure.texts.pause+"</a>").hide().click(a.exposure.pauseSlideshow))})}if(a.exposure.keyboardNavigation){a(document).bind("keyup","left",a.exposure.prevImage);a(document).bind("keyup","right",a.exposure.nextImage);a(document).bind("keyup","ctrl+left",a.exposure.prevPage);a(document).bind("keyup","ctrl+right",a.exposure.nextPage);a(document).bind("keyup","up",a.exposure.lastImage);a(document).bind("keyup","down",a.exposure.firstImage);a(document).bind("keyup","ctrl+up",a.exposure.lastPage);a(document).bind("keyup","ctrl+down",a.exposure.firstPage);if(a.exposure.enableSlideshow){a(document).bind("keyup","space",a.exposure.toggleSlideshow)}}if(a.exposure.fullScreen){a(window).resize(a.exposure.fitToWindow);a('<div class="exposureMask"></div>').click(a.exposure.exitFullScreen).insertAfter(m);if(a.exposure.keyboardNavigation){a(document).bind("keyup","esc",a.exposure.exitFullScreen)}}var l=null;if(a.exposure.jsonSource){if(b.object(a.exposure.jsonSource)){l=a.exposure.jsonSource}else{if(a.exposure.jsonSource.length){if(b.startsWith(a.exposure.jsonSource,"http://")||b.startsWith(a.exposure.jsonSource,"https://")){l=a.ajax({url:a.exposure.jsonSource,type:"GET",async:false}).responseText}else{l=a.exposure.jsonSource}}}}return this.addClass("exposureThumbs").each(function(){var t;if(l){var v=b.object(l)?l:a.parseJSON(l);if(v&&v.data){for(t in v.data){var u=v.data[t];if(u.source&&u.source.length){var n=a("<li></li>");var p=a("<a></a>").attr("href",u.source);if(u.thumb_source&&u.thumb_source.length){var o=a("<img />").attr("src",u.thumb_source);if(u.caption&&u.caption.length){o.attr("title",u.caption)}p.append(o)}else{if(u.caption&&u.caption.length){p.attr("title",u.caption)}}n.append(p);if(u.extra_data&&u.extra_data.length){n.append(a(u.extra_data))}a(this).append(n)}}}}var q=false;var s=false;if(a(this).children("li").length){var r=null;a(this).show().children("li").each(function(){q=true;var w=a(this).find("a");if(w.length){w=a(w[0]);var x=w.attr("href");var A=w.find("img");var B=A.length?A.attr("src"):w.attr("rel");var z=A.length?A.attr("title"):w.attr("title");var i=w.hasClass("selected")&&!r;w.remove();var C=a(this).html();if(B){s=true}a(this).remove();var y=b.newImage(x,B,z,C);if(y>-1){if(i){r=y}if(b.loadQueue.length<a.exposure.preloadBuffer){b.addToLoadQueue(y)}}}else{a(this).remove()}});if(!a.exposure.showThumbs){a.exposure.pageSize=1;a(".exposureThumbs").remove()}if(q){b.preloadNextInQueue();b.createPaging();if(r){a.exposure.goToPage(a.exposure.pageNumberForImage(r));a.exposure.viewImage(r)}else{a.exposure.goToPage(1)}if(a.exposure.enableSlideshow&&a.exposure.autostartSlideshow){a.exposure.playSlideshow()}}else{a.exposure.onEmpty()}}else{a.exposure.onEmpty()}a.exposure.onInit();b.initialized=true})};b.defined=function(c){return typeof c!=="undefined"};b.object=function(c){return typeof c==="object"};b.startsWith=function(c,d){if(c&&d){return c.match("^"+d)===d}return false};b.widthDiff=function(c){return c?c.outerWidth(true)-c.width():0};b.heightDiff=function(c){return c?c.outerHeight(true)-c.height():0};b.Image=function(e,c,d,f){this.src=e;this.thumb=c;this.caption=d;this.data=f;this.loaded=false};b.images=[];b.sources={};b.newImage=function(d,g,h,e){var f=b.defined(b.sources[d]);if(f&&!a.exposure.allowDuplicates){return -1}var i=new b.Image(d,g,h,e);var c=b.images.push(i)-1;if(!f){b.sources[d]=c}return c};b.initialized=false;b.current=-1;b.deselectCurrentImage=function(){b.current=-1;a(".exposureThumbs li.active").removeClass("active")};b.loadQueue=[];b.addToLoadQueue=function(c){if(!b.loaded(c)&&!b.queued(c)){b.loadQueue.push(c)}};b.queued=function(c){return a.inArray(c,b.loadQueue)>-1};b.loaded=function(d){var c=a.exposure.getImage(d);if(c!==null){return c.loaded}return false};b.nextInLoadQueue=function(){var c;if(b.loadQueue.length>0){var d=b.loadQueue.shift();if(b.loaded(d)){c=a.inArray(index,b.loadQueue);b.loadQueue.splice(c,1);return b.nextInLoadQueue()}return d}return null};b.preloadNextInQueue=function(){if(b.loadQueue.length>0){var c=b.nextInLoadQueue();if(c!==null){b.loadImage(c,b.preloadNextInQueue)}}};b.loadPage=function(d,e){if(b.validPage(d)){var f=d*a.exposure.pageSize;var c=f-a.exposure.pageSize;if(f>b.images.length){f=b.images.length}b.pageTransition=true;b.viewThumbs(c,f-1);if(!a.exposure.separatePageBrowsing){if(e){a.exposure.viewImage(e)}else{if(d>1||((d===1&&a.exposure.viewFirstImage)||b.initialized)){a.exposure.viewImage(c)}}}b.pageTransition=false}};b.viewThumbs=function(c,g){var f;if(a.exposure.showThumbs){for(f=c;f<=g;f++){b.viewThumb(f,f===c,f===g,true)}if(!a.exposure.carouselControls&&b.currentPage<a.exposure.numberOfPages()){var d=g+1;var e=g+a.exposure.pageSize;if(e>=b.images.length){e=b.images.length-1}for(f=d;f<=e;f++){var h=b.viewThumb(f,f===d,f===e,false);if(h&&h.length){h.hide()}}}}};b.viewThumb=function(g,d,f,c){if(g<0){g=b.images.length+g}else{if(g>=b.images.length){g=g-b.images.length}}var e=b.images[g];var h=a.exposure.getThumb(g).parent();if(!h.length){h=b.createThumbForImage(e,g);h.attr("rel",a.exposure.pageNumberForImage(g))}if(h.length){h.parent().append(h);if(d){h.addClass("first")}else{h.removeClass("first")}if(f){h.addClass("last")}else{h.removeClass("last")}if(c){if(a.exposure.carouselControls){h.show()}else{h.addClass("current")}}}return h};b.loadImage=function(d,c){var g=a.exposure.getImage(d);var e=a("<img />").addClass("exposureImage");var f;if(g!==null){g.loaded=true;if(b.queued(d)){f=a.inArray(d,b.loadQueue);b.loadQueue.splice(f,1)}if(typeof c==="function"){e.load(c)}e.attr("src",g.src)}return e};b.createThumbForImage=function(f,g){if(a.exposure.showThumbs){var e=a.exposure.getThumb(g);if(e===null||!e.length){var i=a("<li></li>");a(".exposureThumbs").append(i);e=a("<img />");if(f.thumb){e.attr("src",f.thumb)}else{e.attr("src",f.src);var h=Math.ceil(e.width()/e.height()*i.height());var d=Math.ceil(e.height()/e.width()*i.width());if(h<d){e.css({height:"auto",maxWidth:i.width()})}else{e.css({width:"auto",maxHeight:i.height()})}}i.append(e.css("display","block"));e.attr("rel",g);if(f.caption&&a.exposure.showThumbToolTip){e.attr("title",f.caption)}if(f.caption&&a.exposure.showThumbCaption){var c=a('<div class="thumbCaption" />').css({display:"none"}).html(f.caption).attr("title",f.caption);i.append(c)}e.data("data",f.data);e.click(function(){a.exposure.viewImage(Number(a(this).attr("rel")))});e.load(function(){var j=a(this).height();var k=a(this).siblings("div").css({display:""}).length>0;if(j>0){j=k?j+12:j;a(this).parent().height(j)}else{if(k){a(this).parent().height("102px")}}}).each(function(){if(this.complete){a(this).trigger("load")}});a.exposure.onThumb(e);return i}}return null};b.currentPage=1;b.validPage=function(c){return c>0&&c<=a.exposure.numberOfPages()};b.createPaging=function(){var c;if(a.exposure.showControls&&a.exposure.controls.pageNumbers){var d=a.exposure.imageControls?a.exposure.numberOfImages():a.exposure.numberOfPages();a(".exposurePaging").each(function(){for(c=1;c<=d;c++){a(this).append(b.newPagingLink(c))}})}};b.updatePaging=function(c){if(a.exposure.showControls&&a.exposure.controls.pageNumbers){var g=a.exposure.imageControls?b.current+1:b.currentPage;a(".exposurePaging span.active").each(function(){a(this).replaceWith(b.newPagingLink(g))});a('.exposurePaging a[rel="'+c+'"]').each(function(){a(this).replaceWith(a("<span>"+c+"</span>").addClass("active"))});var h=a.exposure.imageControls?a.exposure.numberOfImages():a.exposure.numberOfPages();if(a.exposure.visiblePages>0&&h>a.exposure.visiblePages){var f=c;var e=a.exposure.visiblePages;var d=Math.floor(a.exposure.visiblePages/2);if(c<=d){f=1}else{if(c>(h-d)){e=h;f=e-a.exposure.visiblePages+1}else{f-=d;e=f+a.exposure.visiblePages-1}}a(".exposurePaging").each(function(){a(this).children().each(function(j){var k=j+1;if(k>=f&&k<=e){a(this).show()}else{a(this).hide()}})})}}};b.newPagingLink=function(c){return a.exposure.onPagingLink(a('<a href="javascript:void(0);" rel="'+c+'">'+c+"</a>").click(function(){var d=Number(a(this).attr("rel"));if(a.exposure.imageControls){a.exposure.viewImage(d-1)}else{a.exposure.goToPage(d)}}))};b.pageTransition=false;b.playingSlideshow=false;b.slideshowTimer=null;b.slideshowTransition=false;b.slideshow=function(){b.slideshowTimer=setTimeout(function(){b.slideshowTransition=true;a.exposure.nextImage();b.slideshowTransition=false;b.slideshow()},a.exposure.slideshowDelay)};b.infullScreen=false;b.actualMaxWidth=function(c,d){return a.exposure.maxWidth?a.exposure.maxWidth-(b.widthDiff(c)+b.widthDiff(d)):0};b.actualMaxHeight=function(c,d){return a.exposure.maxHeight?a.exposure.maxHeight-(b.heightDiff(c)+b.heightDiff(d)):0};b.fitToMaxSize=function(f){var d=a(".exposureTarget");if(a.exposure.stretchToMaxSize){if(a.exposure.maxWidth){f.width(b.actualMaxWidth(f,d))}if(a.exposure.maxHeight){f.height(b.actualMaxHeight(f,d))}}else{if(f.width()>f.height()){b.fitToMaxWidth(f,d);b.fitToMaxHeight(f,d)}else{if(f.height()>f.width()){b.fitToMaxHeight(f,d);b.fitToMaxWidth(f,d)}else{var e=b.actualMaxHeight(f,d);var c=b.actualMaxWidth(f,d);if(!c||(e&&c&&e<c)){c=e}if(c&&f.width()>c){f.width(c);f.height(c)}}}}};b.centerImageInWindow=function(c){var d=a(".exposureTarget");d.width(c.width()).height(c.height());d.css({top:(a(window).height()-d.outerHeight(true))/2,left:(a(window).width()-d.outerWidth(true))/2});a(".exposureLastImage").each(function(){a(this).css({top:(d.height()-a(this).height())/2,left:(d.width()-a(this).width())/2})})};b.fitToMaxWidth=function(f,e){var c=b.actualMaxWidth(f,e);if(c&&f.width()>c){var d=Math.round(c*f.height()/f.width());f.height(d);f.width(c)}};b.fitToMaxHeight=function(f,d){var e=b.actualMaxHeight(f,d);if(e&&f.height()>e){var c=Math.round(e*f.width()/f.height());f.width(c);f.height(e)}};b.resizeContainer=function(c){b.fitToMaxSize(c);if(!a.exposure.fixedContainerSize){a(".exposureTarget").show().width(c.width()).height(c.height())}};a.extend({exposure:{pageNumberForImage:function(c){return Math.ceil((c+1)/a.exposure.pageSize)},numberOfPages:function(){return a.exposure.pageNumberForImage(b.images.length-1)},atFirstPage:function(){return b.currentPage===1},atLastPage:function(){return b.currentPage===a.exposure.numberOfPages()},firstImageOnPage:function(c){if(!c){c=b.current}return a.exposure.pageSize===1||(c%a.exposure.pageSize===0)},lastImageOnPage:function(g){if(!g){g=b.current}var h=b.images.length;if(a.exposure.pageSize===1||h===1){return true}if(g>0){var d=a.exposure.pageSize;var e=a.exposure.pageNumberForImage(g);if(e===a.exposure.numberOfPages()){var f=h%a.exposure.pageSize;if(f>0){d=f}}var c=g;if(e>1){c-=(e-1)*a.exposure.pageSize}return(c+1)%d===0}return false},currentPage:function(){return b.currentPage},numberOfImages:function(){return b.images.length},atFirstImage:function(){return b.current===0},atLastImage:function(){return b.current===a.exposure.numberOfImages()-1},getImage:function(c){if(c!==null&&c>-1&&c<b.images.length){return b.images[c]}return null},indexOfImage:function(c){if(c&&b.defined(b.sources[c])){return b.sources[c]}return -1},currentImage:function(){return b.current},addImage:function(d,g,f,e){var k=a.exposure.numberOfPages();var h=b.newImage(d,g,f,e);if(h>-1){var i=a.exposure.pageNumberForImage(h);var c=a('.exposureThumbs li[rel="'+i+'"]');if(c.length){c.removeClass("last")}var j=i>k;if(j){a(".exposurePaging").empty();b.createPaging()}if(j||i===b.currentPage){a.exposure.goToPage(b.currentPage)}}},removeImage:function(g){if(b.images.length===1){a.exposure.removeAllImages()}else{if(a.exposure.enableSlideshow){a.exposure.pauseSlideshow()}var c=a.exposure.numberOfPages();b.images.splice(g,1);var f=a.inArray(g,b.loadQueue);if(f>-1){b.loadQueue.splice(f,1)}var h=a.exposure.getThumb(g).parent();h.remove();a(".exposureThumbs > li").each(function(j){if(j>=g){var k=a.exposure.pageNumberForImage(j);a(this).attr("rel",k);a(this).find("img").attr("rel",j);if(a.exposure.firstImageOnPage(j)){a(this).addClass("first")}else{a(this).removeClass("first")}if(a.exposure.lastImageOnPage(j)){a(this).addClass("last")}else{a(this).removeClass("last")}if(b.currentPage===k){a(this).show()}else{a(this).hide()}}});var d=a.exposure.numberOfPages<c;if(d){a(".exposurePaging").empty();b.createPaging()}if(b.current===g){b.current=-1;var e=g;if(g===a.exposure.numberOfImages()){e=0}a.exposure.viewImage(e)}}},removeAllImages:function(){b.images=[];b.sources={};b.loadQueue=[];if(a.exposure.enableSlideshow){a.exposure.pauseSlideshow()}a(".exposureThumbs").empty();a(".exposurePaging").empty();a.exposure.viewImage(0)},getThumb:function(c){return a('.exposureThumbs img[rel="'+c+'"]')},getNextImage:function(){if(b.current===b.images.length-1){if(a.exposure.loop){return 0}else{a.exposure.onEndOfLoop()}}else{return b.current+1}return null},getPrevImage:function(){if(b.current===0){if(a.exposure.loop){return b.images.length-1}}else{return b.current-1}return null},goToPage:function(d,c){if(b.validPage(d)){a(".exposureThumbs li").removeClass("current").hide();b.loadPage(d,c);if(!a.exposure.imageControls){b.updatePaging(d)}b.currentPage=d;if(a.exposure.showControls){if(a.exposure.atFirstPage()){if(a.exposure.controls.firstLast){a(".exposureFirstPage").addClass("disabled")}if(!a.exposure.loop&&a.exposure.controls.prevNext){a(".exposurePrevPage").hide()}}else{if(a.exposure.controls.firstLast){a(".exposureFirstPage").removeClass("disabled")}if(!a.exposure.loop&&a.exposure.controls.prevNext){a(".exposurePrevPage").show()}}if(a.exposure.atLastPage()){if(a.exposure.controls.firstLast){a(".exposureLastPage").addClass("disabled")}if(!a.exposure.loop&&a.exposure.controls.prevNext){a(".exposureNextPage").hide()}}else{if(a.exposure.controls.firstLast){a(".exposureLastPage").removeClass("disabled")}if(!a.exposure.loop&&a.exposure.controls.prevNext){a(".exposureNextPage").show()}}}if(!a.exposure.carouselControls){a.exposure.onPageChanged()}}},firstPage:function(){if(!a.exposure.atFirstPage()){a.exposure.goToPage(1)}},lastPage:function(){if(!a.exposure.atLastPage()){a.exposure.goToPage(a.exposure.numberOfPages())}},prevPage:function(){if(!a.exposure.atFirstPage()){a.exposure.goToPage(b.currentPage-1)}else{if(a.exposure.loop){a.exposure.goToPage(a.exposure.numberOfPages())}}},nextPage:function(){if(!a.exposure.atLastPage()){a.exposure.goToPage(b.currentPage+1)}else{if(a.exposure.loop){a.exposure.goToPage(1)}}},viewImage:function(l){if(b.current!==l){if(a.exposure.enableSlideshow&&!b.slideshowTransition){}var g=a(".exposureWrapper");var n=false;var h=b.images[l];if(h){var c=h.src;var m=h.caption;var f=h.data;if(c){n=true;var p=a.exposure.showThumbs;var d=null;if(a.exposure.showThumbs){d=a('.exposureThumbs img[rel="'+l+'"]');p=d&&d.length;if(p){d.parent().siblings().removeClass("active");d.parent().addClass("active")}else{a(".exposureThumbs li.active").removeClass("active")}}g.parent().removeClass("exposureLoaded");if(b.loaded(l)){g.parent().addClass("exposureLoaded")}var o=b.loadImage(l,function(){var r=g.find(".exposureImage");if(r.length){r.removeClass("exposureCurrentImage");r.addClass("exposureLastImage")}a(this).addClass("exposureCurrentImage");g.append(a(this));if(a.exposure.clickingNavigation){a(this).click(a.exposure.nextImage)}if(!a(this).width()||!a(this).height()){var t=a(this);var v=setInterval(function(){b.resizeContainer(t);clearTimeout(v)},2)}else{b.resizeContainer(a(this))}if(a.exposure.fullScreen&&!b.infullScreen){a.exposure.onEnterFullScreen(a(".exposureMask"));b.infullScreen=true}var q=a.exposure.dataTarget?a(a.exposure.dataTarget):g.siblings(".exposureData");if(q.length){if(a.exposure.showCaptions){var s=q.find(".caption");if(s.length){s.empty();if(!m&&p){m=d.attr("title")}}s.html(m)}if(a.exposure.showExtraData){var u=q.find(".extra");if(u.length){u.empty();if(!f&&p){f=d.data("data")}u.html(f)}}}a.exposure.onImage(a(this),q,d);b.preloadNextInQueue()})}}if(!n){g.siblings().andSelf().empty();a(".exposureThumbs li.active").removeClass("active")}if(a.exposure.imageControls){var j=a.exposure.pageNumberForImage(l);if(b.currentPage!==j&&!b.pageTransition){a.exposure.goToPage(j,l)}b.updatePaging(l+1)}b.current=l;if(a.exposure.carouselControls&&b.images.length>a.exposure.pageSize){var k=l;var i=a.exposure.pageSize-1;var e=Math.floor(a.exposure.pageSize/2);if(!a.exposure.loop&&l<e){k=0}else{if(!a.exposure.loop&&l>=(b.images.length-e)){i=b.images.length-1;k=i-a.exposure.pageSize}else{k-=e;i=k+a.exposure.pageSize-1}}a.exposure.onCarousel(k,i);a(".exposureThumbs li").removeClass("current").hide();b.viewThumbs(k,i);b.currentPage=a.exposure.pageNumberForImage(l)}}},firstImage:function(){if(!a.exposure.atFirstImage()){if(a.exposure.separatePageBrowsing||a.exposure.atFirstPage()){a.exposure.viewImage(0)}else{a.exposure.goToPage(1)}}},nextImage:function(){if(!a.exposure.separatePageBrowsing&&a.exposure.lastImageOnPage()){if(a.exposure.atLastPage()&&a.exposure.loop){a.exposure.goToPage(1)}else{a.exposure.goToPage(b.currentPage+1)}a.exposure.onNext()}else{var c=a.exposure.getNextImage();if(c!==null){a.exposure.viewImage(c);a.exposure.onNext()}}var d=a.exposure.getNextImage();if(d!==null){b.addToLoadQueue(d)}},prevImage:function(){if(!a.exposure.separatePageBrowsing&&a.exposure.firstImageOnPage()){if(a.exposure.atFirstPage()&&a.exposure.loop){a.exposure.goToPage(a.exposure.numberOfPages(),a.exposure.numberOfImages()-1)}else{var d=b.currentPage-1;a.exposure.goToPage(d,d*a.exposure.pageSize-1)}a.exposure.onPrev()}else{var e=a.exposure.getPrevImage();if(e!==null){a.exposure.viewImage(e);a.exposure.onPrev()}}var c=a.exposure.getPrevImage();if(c!==null){b.addToLoadQueue(c)}},lastImage:function(){if(!a.exposure.atLastImage()){if(a.exposure.separatePageBrowsing||a.exposure.atLastPage()){a.exposure.viewImage(a.exposure.numberOfImages()-1)}else{a.exposure.goToPage(a.exposure.numberOfPages(),a.exposure.numberOfImages()-1)}}},playSlideshow:function(){if(!b.playingSlideshow){if(a.exposure.slideshowControlsTarget){a(".exposurePlaySlideshow").hide();a(".exposurePauseSlideshow").show()}b.slideshow();b.playingSlideshow=true}a.exposure.onSlideshowPlayed()},pauseSlideshow:function(){if(b.playingSlideshow){if(a.exposure.slideshowControlsTarget){a(".exposurePlaySlideshow").show();a(".exposurePauseSlideshow").hide()}b.playingSlideshow=false;if(b.slideshowTimer){clearTimeout(b.slideshowTimer)}a.exposure.onSlideshowPaused()}},toggleSlideshow:function(){if(b.playingSlideshow){a.exposure.pauseSlideshow()}else{a.exposure.playSlideshow()}},first:function(){if(a.exposure.imageControls){a.exposure.firstImage()}else{a.exposure.firstPage()}},prev:function(){if(a.exposure.imageControls){a.exposure.prevImage()}else{a.exposure.prevPage()}},next:function(){if(a.exposure.imageControls){a.exposure.nextImage()}else{a.exposure.nextPage()}},last:function(){if(a.exposure.imageControls){a.exposure.lastImage()}else{a.exposure.lastPage()}},exitFullScreen:function(){if(b.infullScreen){a.exposure.pauseSlideshow();b.deselectCurrentImage();a.exposure.onExitFullScreen(a(".exposureTarget"),a(".exposureMask"));b.infullScreen=false}},fitToWindow:function(){a.exposure.maxWidth=a(window).width();a.exposure.maxHeight=a(window).height();var c=a(".exposureCurrentImage").width("auto").height("auto");b.fitToMaxSize(c);if(!c.width()||!c.height()){var d=setInterval(function(){b.centerImageInWindow(c);clearTimeout(d)},2)}else{b.centerImageInWindow(c)}},texts:{first:"First",previous:"Prev",next:"Next",last:"Last",play:"Play slideshow",pause:"Pause slideshow"}}})})(jQuery);(function(a){a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};function b(c){if(typeof c.data!=="string"){return}var e=c.handler,d=c.data.toLowerCase().split(" ");c.handler=function(f){if(this!==f.target&&(/textarea|select/i.test(f.target.nodeName)||f.target.type==="text")){return}var k=f.type!=="keypress"&&a.hotkeys.specialKeys[f.which],h=String.fromCharCode(f.which).toLowerCase(),m,o="",n={};if(f.altKey&&k!=="alt"){o+="alt+"}if(f.ctrlKey&&k!=="ctrl"){o+="ctrl+"}if(f.metaKey&&!f.ctrlKey&&k!=="meta"){o+="meta+"}if(f.shiftKey&&k!=="shift"){o+="shift+"}if(k){n[o+k]=true}else{n[o+h]=true;n[o+a.hotkeys.shiftNums[h]]=true;if(o==="shift+"){n[a.hotkeys.shiftNums[h]]=true}}for(var g=0,j=d.length;g<j;g++){if(n[d[g]]){return e.apply(this,arguments)}}}}a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:b}})})(jQuery);parent.$("#cboxClose").unbind("click");parent.$("#Close").click(function(){parent.$.fn.colorbox.close()});(function(a){if(!a.focusFx){a.focusFx={}}a.extend(a.focusFx,{photoCount:0,canMaintain:false,slideShowInit:function(){parent.$("#Print").click(function(){window.focus();DoPrintWithBrowserCheck(window)});parent.$("#ViewFullImage").click(function(){var e=(a(".exposureCurrentImage").attr("src")||a("#gallerySingle img").attr("src"));var f="a[href$='"+e.substr(e.lastIndexOf("/")+1)+"']";var d=a(f,"#fullImageLinks").attr("href");if(d!==undefined&&d!=""){window.open(d,"_blank").focus()}});parent.$("#cboxTitle").append('&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="slideshowCounter"></span>');if(a("#galleryView ul.exposure").length>0){loadExposure();a("#galleryView").fadeIn()}else{if(a("#galleryView li").length>0){loadGalleryView();a("#galleryView").fadeIn()}else{a("#gallerySingle").fadeIn();parent.$("#ToggleSS").hide();a(".exposureData").show();a("#gallerySingle>img, .exposureData").hover(function(){a(".exposureData").stop().animate({bottom:"0"},{queue:false,duration:1000})},function(){a(".exposureData").stop().animate({bottom:"-160px"},{queue:false,duration:1000})});var c=a("#gallerySingle>img");centerPrimaryImage(c)}}if(a.focusFx.canMaintain){var b=parent.parent.parent.getAppHeight();b=b>900?850:b-50;parent.$("#cboxClose").append('<button id="maintainPhoto">Maintain</button>');parent.$("#maintainPhoto").insertBefore("#ToggleSS").click(function(){var d=maintainUrl;parent.$.fn.colorbox({href:d,iframe:true,width:"990px",height:b+"px",title:"Picture Administration - "+listingId,close:'<button id="Close">Cancel</button>',onClosed:false})})}}})})(jQuery);function toggleGalleryViewSlideShow(){if($("#photos").hasClass("paused")){$(this).text("Stop Slideshow");$("#photos").removeClass("paused")}else{$(this).text("Start Slideshow");$("#photos").addClass("paused")}}function loadGalleryView(){parent.$("#ToggleSS").click(toggleGalleryViewSlideShow);$("#photos").galleryView({show_panels:true,show_filmstrip:true,panel_width:640,panel_height:480,frame_width:96,frame_height:72,start_frame:startIndex,filmstrip_size:20,transition_speed:800,transition_interval:4000,overlay_opacity:0.7,frame_opacity:0.3,pointer_size:8,nav_theme:"dark",easing:"swing",filmstrip_position:"bottom",overlay_position:"bottom",panel_scale:"nocrop",frame_scale:"crop",frame_gap:5,show_captions:false,fade_panels:true,pause_on_hover:false,filmstrip_position:"bottom",onShowItem:function(b,a){var c="Showing "+b+" of "+a;parent.$("#slideshowCounter").html(c)}});parent.$("#ToggleSS").click()}var slideShowRunning=false;function toggleExposureSlideShow(){if($(this).text()=="Start Slideshow"){slideShowRunning=true;$(this).text("Stop Slideshow");$.exposure.playSlideshow()}else{slideShowRunning=false;$(this).text("Start Slideshow");$.exposure.pauseSlideshow()}}function centerPrimaryImage(e){if(e.height===undefined||e.width===undefined){return}$("#exposure, #gallerySingle").css({position:"absolute",top:0,left:0});var c=e.height();var g=e.width();var d=$(document);var a=($("#galleryView").width()||0);var f=Math.floor(((d.height()-c)/2))+"px";var b=Math.floor(((d.width()-g-a)/2))+"px";$("#exposure, #gallerySingle").css({top:f,left:b})}function loadExposure(){$.focusFx.photoCount=$("#photos li").length;$("#upArrow,#leftArrow").click(function(){$.exposure.prevImage();return true});$("#downArrow,#rightArrow").click(function(){$.exposure.nextImage();return true});parent.$("#ToggleSS").click(toggleExposureSlideShow);$("#photos").exposure({carouselControls:true,imageControls:true,pageSize:($.focusFx.photoPageSize||4),onThumb:function(a){var b=a.parents("li");var c=b.hasClass("active")?1:0.5;a.css({display:"none",opacity:c}).stop().fadeIn(200);a.hover(function(){a.fadeTo("fast",1)},function(){b.not(".active").children("img").fadeTo("fast",0.5)})},onImage:function(g,i,c){var a=$(".exposureWrapper").hasClass("exposureHover");$(".exposureWrapper > .exposureLastImage").stop().fadeOut(500,function(){$(this).remove()});var b="Showing "+(parseInt(c.attr("rel"),10)+1)+" of "+$.focusFx.photoCount;parent.$("#slideshowCounter").html(b);g.hide().stop().fadeIn(1000);var f=function(){var l=i.find(".caption").html();var k=i.find(".extra").html();return(l&&l.length>0)||(k&&k.length>0)};var e=function(){i.stop().show().animate({bottom:0+"px"},{queue:false,duration:1000})};var d=function(){if(!slideShowRunning){$(".exposureWrapper").addClass("exposureHover");var k=f();if(k){e.call()}}};var j=function(){var k=-i.outerHeight();i.stop().show().animate({bottom:k+"px"},{queue:false,duration:1000})};var h=function(){if(!slideShowRunning){$(".exposureWrapper").removeClass("exposureHover");if(f()){j.call()}}};if(slideShowRunning){if(f()){e.call()}else{j.call()}}$(".exposureWrapper, #rightArrow, #leftArrow").hover(d,h);i.hover(d,h);if(a){if(f()){e.call()}else{j.call()}}if($.exposure.showThumbs&&c&&c.length){c.parents("li").siblings().children("img.selected").stop().fadeTo(200,0.5,function(){$(this).removeClass("selected")});c.fadeTo("fast",1).addClass("selected")}centerPrimaryImage(g)},onCarousel:function(a,b){$(".exposureThumbs li").hide().children("img.selected").stop().css("opacity",0.5).removeClass("selected")},viewFirstImage:false});$.exposure.viewImage(--startIndex);$(".exposureThumbs").addClass("hideWhenPrinted");parent.$("#ToggleSS").click()};