var labelJson=[];$(function(){$(".imageSpinner").click(function(){var j=$(this);var b=j.attr("rel");var f=$("#labelDiv"+b).length>0;var g=parseInt($("#spnTotImg"+b).text(),10);var i=j.hasClass("imageSpinnerNext")?1:-1;var e=parseInt($("#spnCurImg"+b).text(),10)+i;if(e>g){e=1}else{if(e<=0){e=g}}var d=$("#aryPicDataSpinner"+b).val();if(d!=null&&d.length>0){if(f&&labelJson[b]==null){var h=$("#labelDiv"+b).attr("rel");if(h.length>0){h=$("<div/>").html(h).text();labelJson[b]=JSON.parse(h)}else{labelJson[b]=[]}}var a=d.split(",");var c=$("#img"+b);c.attr("src",a[e-1]);$("#spnCurImg"+b).text(e);c.attr("firstImage",e);if(f&&labelJson[b].length>=(e-1)){$("#labelDiv"+b).text(labelJson[b][e-1]).attr("title",labelJson[b][e-1])}}});$("img[rel^=slideshow]").click(function(){if(typeof(parent.dataController)!="undefined"){var b=parseInt($(this).attr("firstImage"),10)-1;b=b<0?0:b;var a=$(this).attr("listingid");loadSlideShow(a,b)}else{$.jGrowl("Slideshow can only be loaded from search results.",{life:5000})}})});$(function(){$("a.f-integration-redirect,a.f-integration-postredirect,a.f-integration-doccentralpublic").click(function(a){a.preventDefault();var b=$(this).attr("fullWindow");var e=$(this).attr("hideAddressBar");var f=null;var c=null;var d=null;DoIntegrationPointReDirect(this.href,f,c,b,e,d)});$("a.f-integration-multiredirect").click(function(a){a.preventDefault();var g=$(this);var b=g.attr("fullWindow")||g.hasClass("f-integration-full-window");var i=g.attr("hideAddressBar")||g.hasClass("f-integration-hide-address-bar");var j=null;var c=null;var d=null;var k=window.dataController.getSelectedListings();if(k==""){$.jGrowl("Please select one or more listings.");return}if(g.attr("rel")!=""){var e=k.split(",").length;var f=g.attr("rel");if(f<e){$.jGrowl("You have selected too many listings for this integration (maximum: "+f+").  Please reduce the number of selected listings and try again.",{life:5000});return}}var h=this.href.replace(/%7BlistingId%7D/i,k);DoIntegrationPointReDirect(h,j,c,b,i,d)})});function DoIntegrationPointReDirect(g,c,b,e,a,d){var f=getWindowSettings(c,b,e,a,d);var h=getWindowOptions(f);window.open(g,f.name,h.join(","));return false}function DoIntegrationPointRequestRedirect(d,e,f,c,a,b){if(d.length>0){$.ajax(d,{timeout:8000,success:function(j,h){if(j==null||j.status=="error"||j.message.length<1){$.jGrowl("Form Simplicity denied service access.",{life:5000});return}d=j.message;if(parent.parent.window.openNewBrowser&&(c||a)){parent.parent.window.openNewBrowser(d,c,a)}else{var g=getWindowSettings(winHeight,winWidth,c,a,b);var i=getWindowOptions(g);window.open(d,g.name,i.join(","))}},error:function(){$.jGrowl("Form Simplicity service is not available.",{life:5000});return}})}else{$.jGrowl("Form Simplicity service is not available.",{life:5000});return}}function getWindowSettings(c,b,e,a,d){var f={name:"_blank",windowOpts:{status:"yes",titlebar:"yes",toolbar:"yes",left:null,top:null,width:null,height:null,location:"yes",scrollbars:"yes"}};if(c!=null||b!=null){f.windowOpts.width=b;f.windowOpts.height=c}if(e!==undefined&&((typeof(e)==="string"&&e.toLowerCase()=="true")||(typeof(e)==="boolean"&&e))){var h=1020;var g=713;if(screen){h=parseInt(screen.width,10)-16;g=parseInt(screen.height,10)-60}f.windowOpts.status="no";f.windowOpts.titlebar="no";f.windowOpts.toolbar="no";f.windowOpts.left="0";f.windowOpts.top="0";f.windowOpts.width=h;f.windowOpts.height=g}if(a!==undefined&&((typeof(a)==="string"&&a.toLowerCase()=="true")||(typeof(a)==="boolean"&&a))){f.windowOpts.location="no"}$.extend(f,d);return f}function getWindowOptions(a){var c=[];for(var b in a.windowOpts){if(a.windowOpts.hasOwnProperty(b)&&a.windowOpts[b]!=null){c.push(b+"="+a.windowOpts[b])}}return c};$(function(){$("a.f-integration-hillsidecart-link").click(function(a){a.preventDefault();var e=$(this);var b="What list would you like to add this listing to?";var c=prompt(b,"");if(c==null){return}var d=e.attr("href")+"?ids="+e.find("img.f-integration-hillsidecart-link").attr("listingid")+"&name="+encodeURIComponent(c);UpdateHillside(d)});$("a.f-integration-multihillsidecart").click(function(b){b.preventDefault();var e=$(this);var g=window.dataController.getSelectedListings();if(g==""){$.jGrowl("Please select one or more listings.");return}var c=g.split(",").length;if(e.attr("rel")!=""){var d=e.attr("rel");if(d<c){$.jGrowl("You have selected too many listings for this integration (maximum: "+d+").  Please reduce the number of selected listings and try again.",{life:5000});return}}var a=c==1?"What list would you like to add this listing to?":"What list would you like to add these listings to?";var h=prompt(a,"");if(h==null){return}var f=this.href+"?ids="+g+"&name="+encodeURIComponent(h);UpdateHillside(f)})});function UpdateHillside(a){$.ajax({url:a}).done(function(b){$.jGrowl(b.result)})};var _inColorBox=false;$(function(){if(parent.dataController!=null){parent.dataController.syncView(currentViewId);if(parent.dataController.CurrentViewID==26){$("input.selectDoc").click(PushSelectedDoc);if(parent.dataController.SelectedDocs.length>0){syncDoc();parent.$("#Email").removeClass("sf-disabled")}else{parent.$("#Email").addClass("sf-disabled")}}}else{$("a[class^='f-integration-'],a[class*=' f-integration-']").remove()}_inColorBox=(parent.parent.$("#cboxIframe").length>0);if(typeof(parent.doReportIntegrationUpdates)!="undefined"){setTimeout(function(){parent.doReportIntegrationUpdates()},100)}$("a.DefaultLinkDetail").click(function(){var a=$(this).text();parent.dataController.loadDefaultView(a,0,false)});$("a[modalType]").click(function(a){var f=$(this).attr("rel");var d=$(this).attr("modalType");var c=$(this).attr("modalTitle");var b=parent.parent.$;if(_inColorBox){b=$}if(c==""){c="Modal Report"}b.fn.colorbox({href:modalReportUrl+"?sharedID="+f+"&modalType="+d,open:true,iframe:true,width:700,height:400,title:c,close:'<button id="Close">Close</button>'})});$("a.f-integration-TaxListingView-link").click(function(a){a.preventDefault();parent.parent.$.fn.colorbox({href:parent.dataController.loadIntegrationView($(this).attr("listid"),"","Paragon Tax"),open:true,iframe:true,width:$(this).attr("cboxwidth"),height:$(this).attr("cboxheight"),close:'<button id="Close" onClick="javascript:$.fn.colorbox.close();">Close</button>',title:$(this).text(),onClosed:false})});$("a img.f-integration-colorbox-link, a img.f-integration-minbox-link").click(function(f){f.preventDefault();var g=$(this);var h=g.attr("class").split(" ").slice(-1)[0].replace("f-listing-","").split(":");var a=g.attr("cboxwidth");a=a!=null&&a.length>0?a:875;var i=g.attr("cboxheight");i=i!=null&&i.length>0?i:500;var c=window.top.getAppHeight();i=c>i?i:c-50;var b=parent.dataController.loadIntegrationView(h[0],h.length>1?h[1]:0,g.attr("alt"));if(b==""){b=$(this).parent().attr("href")}var d={href:b,open:true,iframe:true,width:a,height:i,close:'<button id="Close" onClick="javascript:$.fn.colorbox.close();">Close</button>',title:$(this).attr("alt"),onClosed:false};if(g.hasClass("f-integration-minbox-link")){$.extend(d,{minUrl:d.href,minName:g.attr("title"),alwaysOverwrite:true,close:'<button id="Minimize">Minimize</button><button id="Close">Close</button>'});d.href=null;parent.parent.$.fn.minbox(d)}else{parent.parent.$.fn.colorbox(d)}});$("a img.f-integration-searchview-link").click(function(a){a.preventDefault();var b=$(this).attr("class").split(" ").slice(-1)[0].replace("f-listing-","").split(":");location.href=parent.dataController.loadIntegrationView(b[0],b.length>1?b[1]:0,$(this).attr("alt"))});$(".listingCheckBox").each(function(){if(parent.dataController!=null){var a=String($(this).attr("rel")).split(":");if(a.length==2){$(this).prop("checked",parent.dataController.isSelected(a[0],a[1]))}}});$(".listingCheckBox").click(function(){if(parent.dataController!=null){var d=String($(this).attr("rel")).split(":");if(d.length==2){var c=$(this).prop("checked");var a=d[0];var b=d[1];if(d[0]==""){d=String($(this).attr("id")).split("_");a=d[1];b=d[2]}parent.dataController.selectID(a,b,c)}}});if(parent.$("#cboxClose").length>0&&parent.$("#cboxClose").html().indexOf("Print")<0){parent.$("#cboxClose").append('<button id="Print">Print</button>');parent.$("#Print").insertBefore("#Close")}else{parent.$("#cboxClose").html("");parent.$("#cboxClose").append('<button id="Print">Print</button><button id="Close">Close</button>')}parent.$("#cboxClose").unbind("click");parent.$("#Close").click(function(){parent.$.fn.colorbox.close()});parent.$("#Print").click(function(){var a=parent.document.getElementById("cboxIframe").contentWindow;a.focus();DoPrintWithBrowserCheck(a)});if(_inColorBox&&isTabletDevice()){$("#divHtmlReport").css("overflow","auto").height("530px")}if(autoPrint){window.setTimeout(function(){window.focus();if($.browser.msie){window.document.execCommand("print",false,null)}else{DoPrintWithBrowserCheck(window)}},100)}});function syncDoc(){var a=parent.dataController.SelectedDocs;$("input.selectDoc").each(function(){var c=$(this).attr("rel");for(var b=0;b<a.length;b++){if(a[b]==c){$(this).prop("checked",true);break}}})}function PushSelectedDoc(){var a=parent;var c=$(this).prop("checked");var b=$(this).attr("rel");if(c==false){a.dataController.popSelectedDoc(b)}else{a.dataController.pushSelectedDoc(b)}if(a.dataController.SelectedDocs.length>0){a.$("#Email").removeClass("sf-disabled")}else{a.$("#Email").addClass("sf-disabled")}}function ShowEmail(a,c){var b="";if(parent.dataController.SelectedDocs.length>0){b=parent.dataController.SelectedDocs.join()}parent.parent.$.fn.minbox({minUrl:emailManagerUrl+"?to="+a+"&subject="+c+"&attachments="+b,minName:"email",open:true,width:"905px",height:"620px",title:"Compose E-Mail",close:'<button id="sendMail">Send</button><button id="Minimize">Minimize</button><button id="cancel">Cancel</button>',onClosed:false})}function GetContent(d){var c="22";if(parent.dataController!=null){c=parent.dataController.getDefaultViewID()}else{var e=$("#searchId").val();var a=parent.document.getElementById(e);if(a!=null&&a.contentWindow.dataController!=null){c=a.contentWindow.dataController.getDefaultViewID()}}var b=reportUrl+"&listingIDs="+d+"&viewID="+c;parent.parent.$.fn.colorbox({href:b,transition:"none",open:true,iframe:true,width:"840",height:"600",close:'<button id="Close">Close</button>',title:"Listing Report"});parent.parent.$("#Close").click(function(){parent.parent.$.fn.colorbox.close()})}function showFullAuditDetail(f,c,a,b,e){var d=reportUrl+"&outputtype=HTML&IsCurrent="+f.toString()+"&num="+c+"&listingIDs="+a+"&viewID="+b+"&AuditFullDetailAuditNum="+e;parent.parent.$.fn.colorbox({href:d,transition:"none",open:true,iframe:true,width:"930",height:"600",close:'<button id="Close">Close</button>',title:"Audit Detail",onClosed:false});parent.parent.$("#Close").click(function(){parent.parent.$.fn.colorbox.close()});parent.parent.$("#Email").click(function(){var g;if(e==999){g="Audit Detail Report for MLS "+a+" - Current Audit Version"}else{g="Audit Detail Report for MLS "+a+" - Audit Version "+e}ShowEmail("",g)});parent.parent.$("#Print").click(function(){DoPrintWithBrowserCheck(window)})}function getCurrentView(b,a){if(typeof(parent.dataController)!="undefined"){parent.dataController.loadDefaultView(b,a,false)}else{$.jGrowl("Default view can only be loaded from search results.",{life:5000})}}function selectSSRow(c){var b=c.id.split("_");var a={ID:b[1],UniqueID:b[2]};if($("#"+c.id).prop("checked")){parent.dataController.SelectedIDs.push(a)}}function doAssocDocs(b,a){window.location=parent.dataController.loadIntegrationView(b,"0","Associated Docs")};/*
 * jQuery blockUI plugin
 * Version 2.60.0-2013.04.05
 * @requires jQuery v1.7 or later
 *
 * Examples at: http://malsup.com/jquery/block/
 * Copyright (c) 2007-2013 M. Alsup
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * Thanks to Amir-Hossein Sobhi for some excellent contributions!
 */
(function(){function a(o){o.fn._fadeIn=o.fn.fadeIn;var j=o.noop||function(){};var f=/MSIE/.test(navigator.userAgent);var e=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent);var l=document.documentMode||0;var n=o.isFunction(document.createElement("div").style.setExpression);o.blockUI=function(r){i(window,r)};o.unblockUI=function(r){b(window,r)};o.growlUI=function(s,r,t,u){var v=o('<div class="growlUI"></div>');if(s){v.append("<h1>"+s+"</h1>")}if(r){v.append("<h2>"+r+"</h2>")}if(t===undefined){t=3000}o.blockUI({message:v,fadeIn:700,fadeOut:1000,centerY:false,timeout:t,showOverlay:false,onUnblock:u,css:o.blockUI.defaults.growlCSS})};o.fn.block=function(r){if(this[0]===window){o.blockUI(r);return this}var s=o.extend({},o.blockUI.defaults,r||{});this.each(function(){var t=o(this);if(s.ignoreIfBlocked&&t.data("blockUI.isBlocked")){return}t.unblock({fadeOut:0})});return this.each(function(){if(o.css(this,"position")=="static"){this.style.position="relative";o(this).data("blockUI.static",true)}this.style.zoom=1;i(this,r)})};o.fn.unblock=function(r){if(this[0]===window){o.unblockUI(r);return this}return this.each(function(){b(this,r)})};o.blockUI.version=2.6;o.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:true,theme:false,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:0.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:0.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:false,baseZ:1000,centerX:true,centerY:true,allowBodyStretch:true,bindEvents:true,constrainTabKey:true,fadeIn:200,fadeOut:400,timeout:0,showOverlay:true,focusInput:true,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:false};var g=null;var q=[];function i(J,L){var H,r;var D=(J==window);var u=(L&&L.message!==undefined?L.message:undefined);L=o.extend({},o.blockUI.defaults,L||{});if(L.ignoreIfBlocked&&o(J).data("blockUI.isBlocked")){return}L.overlayCSS=o.extend({},o.blockUI.defaults.overlayCSS,L.overlayCSS||{});H=o.extend({},o.blockUI.defaults.css,L.css||{});if(L.onOverlayClick){L.overlayCSS.cursor="pointer"}r=o.extend({},o.blockUI.defaults.themedCSS,L.themedCSS||{});u=u===undefined?L.message:u;if(D&&g){b(window,{fadeOut:0})}if(u&&typeof u!="string"&&(u.parentNode||u.jquery)){var w=u.jquery?u[0]:u;var E={};o(J).data("blockUI.history",E);E.el=w;E.parent=w.parentNode;E.display=w.style.display;E.position=w.style.position;if(E.parent){E.parent.removeChild(w)}}o(J).data("blockUI.onUnblock",L.onUnblock);var A=L.baseZ;var y,O,N,G;if(f||L.forceIframe){y=o('<iframe class="blockUI" style="z-index:'+(A++)+';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+L.iframeSrc+'"></iframe>')}else{y=o('<div class="blockUI" style="display:none"></div>')}if(L.theme){O=o('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+(A++)+';display:none"></div>')}else{O=o('<div class="blockUI blockOverlay" style="z-index:'+(A++)+';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>')}if(L.theme&&D){G='<div class="blockUI '+L.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(A+10)+';display:none;position:fixed">';if(L.title){G+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(L.title||"&nbsp;")+"</div>"}G+='<div class="ui-widget-content ui-dialog-content"></div>';G+="</div>"}else{if(L.theme){G='<div class="blockUI '+L.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(A+10)+';display:none;position:absolute">';if(L.title){G+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(L.title||"&nbsp;")+"</div>"}G+='<div class="ui-widget-content ui-dialog-content"></div>';G+="</div>"}else{if(D){G='<div class="blockUI '+L.blockMsgClass+' blockPage" style="z-index:'+(A+10)+';display:none;position:fixed"></div>'}else{G='<div class="blockUI '+L.blockMsgClass+' blockElement" style="z-index:'+(A+10)+';display:none;position:absolute"></div>'}}}N=o(G);if(u){if(L.theme){N.css(r);N.addClass("ui-widget-content")}else{N.css(H)}}if(!L.theme){O.css(L.overlayCSS)}O.css("position",D?"fixed":"absolute");if(f||L.forceIframe){y.css("opacity",0)}var B=[y,O,N],x=D?o("body"):o(J);o.each(B,function(){this.appendTo(x)});if(L.theme&&L.draggable&&o.fn.draggable){N.draggable({handle:".ui-dialog-titlebar",cancel:"li"})}var v=n&&(!o.support.boxModel||o("object,embed",D?null:J).length>0);if(e||v){if(D&&L.allowBodyStretch&&o.support.boxModel){o("html,body").css("height","100%")}if((e||!o.support.boxModel)&&!D){var K=d(J,"borderTopWidth"),R=d(J,"borderLeftWidth");var M=K?"(0 - "+K+")":0;var I=R?"(0 - "+R+")":0}o.each(B,function(z,T){var t=T[0].style;t.position="absolute";if(z<2){if(D){t.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+L.quirksmodeOffsetHack+') + "px"')}else{t.setExpression("height",'this.parentNode.offsetHeight + "px"')}if(D){t.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"')}else{t.setExpression("width",'this.parentNode.offsetWidth + "px"')}if(I){t.setExpression("left",I)}if(M){t.setExpression("top",M)}}else{if(L.centerY){if(D){t.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"')}t.marginTop=0}else{if(!L.centerY&&D){var U=(L.css&&L.css.top)?parseInt(L.css.top,10):0;var S="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+U+') + "px"';t.setExpression("top",S)}}}})}if(u){if(L.theme){N.find(".ui-widget-content").append(u)}else{N.append(u)}if(u.jquery||u.nodeType){o(u).show()}}if((f||L.forceIframe)&&L.showOverlay){y.show()}if(L.fadeIn){var Q=L.onBlock?L.onBlock:j;var C=(L.showOverlay&&!u)?Q:j;var F=u?Q:j;if(L.showOverlay){O._fadeIn(L.fadeIn,C)}if(u){N._fadeIn(L.fadeIn,F)}}else{if(L.showOverlay){O.show()}if(u){N.show()}if(L.onBlock){L.onBlock()}}p(1,J,L);if(D){g=N[0];q=o(L.focusableElements,g);if(L.focusInput){setTimeout(h,20)}}else{c(N[0],L.centerX,L.centerY)}if(L.timeout){var P=setTimeout(function(){if(D){o.unblockUI(L)}else{o(J).unblock(L)}},L.timeout);o(J).data("blockUI.timeout",P)}}function b(v,r){var u;var y=(v==window);var x=o(v);var w=x.data("blockUI.history");var s=x.data("blockUI.timeout");if(s){clearTimeout(s);x.removeData("blockUI.timeout")}r=o.extend({},o.blockUI.defaults,r||{});p(0,v,r);if(r.onUnblock===null){r.onUnblock=x.data("blockUI.onUnblock");x.removeData("blockUI.onUnblock")}var t;if(y){t=o("body").children().filter(".blockUI").add("body > .blockUI")}else{t=x.find(">.blockUI")}if(r.cursorReset){if(t.length>1){t[1].style.cursor=r.cursorReset}if(t.length>2){t[2].style.cursor=r.cursorReset}}if(y){g=q=null}if(r.fadeOut){u=t.length;t.fadeOut(r.fadeOut,function(){if(--u===0){k(t,w,r,v)}})}else{k(t,w,r,v)}}function k(s,u,r,t){var z=o(t);s.each(function(w,A){if(this.parentNode){this.parentNode.removeChild(this)}});if(u&&u.el){u.el.style.display=u.display;u.el.style.position=u.position;if(u.parent){u.parent.appendChild(u.el)}z.removeData("blockUI.history")}if(z.data("blockUI.static")){z.css("position","static")}if(typeof r.onUnblock=="function"){r.onUnblock(t,r)}var x=o(document.body),v=x.width(),y=x[0].style.width;x.width(v-1).width(v);x[0].style.width=y}function p(w,s,r){var v=s==window,u=o(s);if(!w&&(v&&!g||!v&&!u.data("blockUI.isBlocked"))){return}u.data("blockUI.isBlocked",w);if(!v||!r.bindEvents||(w&&!r.showOverlay)){return}var t="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";if(w){o(document).bind(t,r,m)}else{o(document).unbind(t,m)}}function m(u){if(u.keyCode&&u.keyCode==9){if(g&&u.data.constrainTabKey){var s=q;var t=!u.shiftKey&&u.target===s[s.length-1];var v=u.shiftKey&&u.target===s[0];if(t||v){setTimeout(function(){h(v)},10);return false}}}var r=u.data;var w=o(u.target);if(w.hasClass("blockOverlay")&&r.onOverlayClick){r.onOverlayClick()}if(w.parents("div."+r.blockMsgClass).length>0){return true}return w.parents().children().filter("div.blockUI").length===0}function h(s){if(!q){return}var r=q[s===true?q.length-1:0];if(r){r.focus()}}function c(v,z,A){var u=v.parentNode,r=v.style;var B=((u.offsetWidth-v.offsetWidth)/2)-d(u,"borderLeftWidth");var w=((u.offsetHeight-v.offsetHeight)/2)-d(u,"borderTopWidth");if(z){r.left=B>0?(B+"px"):"0"}if(A){r.top=w>0?(w+"px"):"0"}}function d(s,r){return parseInt(o.css(s,r),10)||0}}if(typeof define==="function"&&define.amd&&define.amd.jQuery){define(["jquery"],a)}else{a(jQuery)}})();var _SmartMap=null;var _QuickMap=null;$(function(){$(".f-integration-digimap-link").click(function(a){setupDigiMap(a,$(this))})});function setupDigiMap(b,a){b.preventDefault();b.stopImmediatePropagation();var c=a.attr("url");if(c==null||c.length==0){c=a.parent().attr("href")}$.ajax({url:c,dataType:"json",success:function(d){if(d.status=="OK"||d.status=="WARNING"){if(d.status=="OK"||confirm(d.message)){doDigiMap(d.result.url,d.result.addressNumber,d.result.addressDirection,d.result.addressStreet,d.result.address2,d.result.city,d.result.state,d.result.zip,d.result.zip6,d.result.app,d.result.userCode)}}else{$.jGrowl(d.result)}},error:function(d){this.ajaxRetryOnError(d,"The server encountered an unexpected error with Digital Mapping.")}})}function doDigiMap(a,h,i,f,c,g,b,j,k,d,e){gAddr="";gCity="";gZip="";gState="";if(!h.length==0){gAddr+=h}if(!i.length==0){gAddr+=" "+i}if(!f.length==0){gAddr+=" "+f}if(!c.length==0){gAddr+=" "+c}gCity=g;gZip=j;if(!k.length==0){gZip+=" "+k}gState=b;if(_SmartMap==null){_SmartMap=new __DMPSmartMapInterface(a,"_SmartMap",800,600,e)}if(_QuickMap==null){_QuickMap=new __DMPQuickMapInterface(a,"_QuickMap",_SmartMap,e)}if(d=="pinpoint"){_SmartMap.queryByAddress(gAddr,gCity,gState,gZip)}else{_QuickMap.queryByLocation(null,null,gAddr,gCity,gState,gZip)}}function __DMPSmartMapInterface(l,q,e,n,u){var k="toolbar=no,menubar=no,location=no,resizable=yes";if(e==null||isNaN(e)||e<100){e=800}if(n==null||isNaN(n)||n<100){n=600}k+=",height="+n+",width="+e;var m="SmartMap";var c="MSXML2.DOMDocument.3.0";var d=null;var t=false;var o=null;var i=null;var v=null;var f=null;var b=null;var s=null;var g=null;var p=null;var j=null;var a=null;var r=null;var h=null;this.mapWindowExists=function(){try{if(o!=null&&o.closed!=true){return true}}catch(w){}return false};this.isMapReady=function(){if(this.mapWindowExists()==false){t=false;this.openMap()}return t};this.getMapReferenceOnAncestor=function(w){try{if(w==null){return null}if(w._SmartMapWindow!=null&&w._SmartMapWindow.window.closed!=true){return w._SmartMapWindow}var y=null;if(w.parent!=w){y=this.getMapReferenceOnAncestor(w.parent)}if(y!=null){return y}return this.getMapReferenceOnAncestor(w.opener)}catch(x){return null}};this.setMapReferenceOnAncestor=function(x,w){try{if(x==null){return}x._SmartMapWindow=w;if(x.parent!=x){this.setMapReferenceOnAncestor(x.parent,w)}if(x.opener!=null){this.setMapReferenceOnAncestor(x.opener,w)}}catch(y){}};this.openMap=function(){try{if(this.mapWindowExists()){o.focus();return}o=this.getMapReferenceOnAncestor(window);if(o==null){o=window.open(l+"?APPLICATION="+m+"&AgentId="+u,q,k);this.setMapReferenceOnAncestor(window,o)}else{t=true;d=o.window.gObjectManager}o.opener=window;o.window.focus()}catch(w){alert(m+".openMap(): "+w.description)}};this.callBack=function(y){try{var w=y.replace(/[\w|\s|>|<|"|']*eventName='([\w]+)'[\w|\s|>|<|/|'|"]*/g,"$1");if(w=="MapLoad"){t=true;d=o.window.gObjectManager;if(h=="address"&&s==""&&g==""&&p==""&&j==""){h="query"}if(h=="query"){this.query(i,v)}else{if(h=="apn"){this.queryByAPNs(f,b)}else{if(h=="address"){this.queryByAddress(s,g,p,j)}else{if(h=="intersection"){this.queryByIntersection(a,r,b)}else{if(h=="Location"){this.queryByLocation(f,b,s,g,p,j)}}}}}}}catch(x){alert(m+".callBack(): "+x.description)}};this.query=function(x,w){try{h="query";i=x;v=w;if(this.isMapReady()!=true){return}if(x==null||w==null){return}var z=d.constructObject("SmartMapCatalog:QueryHandler");z.setResourceName(x);o.window.focus();z.query(w)}catch(y){alert(m+'.query(resource="'+x+'", condition="'+w+'"): '+y.description)}};this.queryByAPNs=function(w,y){try{h="apn";f=w;b=y;if(this.isMapReady()!=true){return}if(w==null||y==null){return}var z=d.constructObject("SmartMapCatalog:QueryHandler");o.window.focus();z.queryByAPNs(w,y)}catch(x){alert(m+'.queryByAPNs(APN="'+w+'", fips="'+y+'"): '+x.description)}};this.queryByAddress=function(y,A,w,z){try{h="address";s=y;g=A;p=w;j=z;if(this.isMapReady()!=true){return}if(y==null||(A==null&&z==null)){return}var x=d.constructObject("SmartMapCatalog:QueryHandler");o.window.focus();x.queryByAddress(y,A,w,z)}catch(B){alert(m+'.queryByAddress(address="'+y+'", city="'+A+'", state="'+w+'", zip="'+z+'"): '+B.description)}};this.queryByLocation=function(C,w,z,x,B,A){try{h="Location";f=C;b=w;s=z;g=x;p=B;j=A;if(this.isMapReady()!=true){return}if(z==null||(x==null&&A==null)){return}var y=d.constructObject("SmartMapCatalog:QueryHandler");o.window.focus();y.queryByLocation(C,w,z,x,B,A)}catch(D){alert(m+'.queryByLocation(apn="'+C+'", fips="'+w+'", address="'+z+'", city="'+x+'", state="'+B+'", zip="'+A+'"): '+D.description)}};this.queryByIntersection=function(w,y,z){try{h="intersection";a=w;r=y;b=z;if(this.isMapReady()!=true){return}if(w==null&&y==null&&z==null){return}var A=d.constructObject("SmartMapCatalog:QueryHandler");o.window.focus();A.queryByIntersection(w,y,z)}catch(x){alert(m+'.queryByIntersection(street1="'+w+'", street2="'+y+'", fips="'+z+'"): '+x.description)}}}function __DMPQuickMapInterface(h,o,d,r){var a="MSXML2.DOMDocument.3.0";var j="QuickMap";var b=509;var k=455;var g="status=yes,toolbar=no,menubar=no,location=no,fullscreen=no";g+=",height="+k+",width="+b;var q=false;var l=null;var i=null;var c=null;var m=null;var p=null;var e=null;var n=null;var f=null;this.exists=function(){return true};this.mapWindowExists=function(){try{if(l!=null&&l.closed!=true){var t=l.window.environment.packages.getValue("ExternalAppIntegration");if(t!=null){return true}}}catch(s){}return false};this.isMapReady=function(){if(this.mapWindowExists()==false){q=false;this.openMap()}return q};this.getMapReferenceOnAncestor=function(s){try{if(s==null){return null}if(s._QuickMapWindow!=null&&s._QuickMapWindow.window.closed!=true){return s._QuickMapWindow}var u=null;if(s.parent!=s){u=this.getMapReferenceOnAncestor(s.parent)}if(u!=null){return u}return this.getMapReferenceOnAncestor(s.opener)}catch(t){return null}};this.setMapReferenceOnAncestor=function(t,s){try{if(t==null){return}t._QuickMapWindow=s;if(t.parent!=t){this.setMapReferenceOnAncestor(t.parent,s)}if(t.opener!=null){this.setMapReferenceOnAncestor(t.opener,s)}}catch(u){}};this.openMap=function(){try{if(this.mapWindowExists()){l.focus();return}l=this.getMapReferenceOnAncestor(window);if(l==null){l=window.open(h+"?APPLICATION="+j+"&AgentId="+r,o,g);this.setMapReferenceOnAncestor(window,l)}else{q=true}l.opener=window;l.window.focus()}catch(s){alert(j+".openMap(): "+s.description)}};this.callBack=function(u){try{q=true;var s=u.replace(/[\w|\s|>|<|"|']*eventName='([\w]+)'[\w|\s|>|<|/|'|"]*/g,"$1");if(s=="MapLoad"){q=true;gObjectManager=l.window.gObjectManager;if(i=="APN"){this.queryByAPNs(c,m)}else{if(i=="Location"){this.queryByLocation(c,m,p,e,n,f)}}}else{if(s=="OpenSmartMap"){this.openSmartMap(c,m,p,e,n,f)}}}catch(t){alert(j+".callBack(): "+t.description)}};this.queryByAPNs=function(s,u){try{c=s;m=u;i="APN";if(this.isMapReady()!=true){return}if(s==null||u==null){return}l.window.focus();var v=l.window.environment.packages.getValue("ExternalAppIntegration");v.queryByAPNs(s,u)}catch(t){alert(j+'.queryByAPNs(APN="'+s+'", fips="'+u+'"): '+t.description)}};this.queryByLocation=function(y,s,v,t,x,w){try{if(y!=null){y=y.toString()}c=y;m=s;p=v;e=t;n=x;f=w;i="Location";if(this.isMapReady()!=true){return}l.window.focus();var u=l.window.environment.packages.getValue("ExternalAppIntegration");u.queryByLocation(y,s,v,t,x,w)}catch(z){alert(j+'.queryByAPNs(APN="'+y+'", fips="'+s+'"): '+z.description)}};this.openSmartMap=function(x,s,u,t,w,v){try{if(d==null){return}if(x==null&&(u==null||(t==null&&v==null))){d.openMap()}else{d.queryByLocation(x,s,u,t,w,v)}}catch(y){alert("QuickMap.openSmartMap('"+apns+"', "+s+") error: "+y.description)}}};